使用文档

欢迎使用 phone-link-cross 项目，这是一个跨平台的 iOS 设备管理工具。本文档将帮助您快速上手并使用本项目的基本功能。

## 安装与配置

### 1. 环境要求
- Windows 10/11、macOS 或 Linux 系统
- Python 3.6+（可选，用于脚本支持）
- C++ 编译器（如 Visual Studio 2019+、GCC 或 Clang）
- CMake 3.15+

### 2. 依赖安装
本项目的核心依赖是 libimobiledevice，它提供了与 iOS 设备通信所需的功能。

#### Windows 系统
```bash
# 使用项目提供的安装脚本
./build.bat install-deps

# 或者手动安装
python scripts/install-deps.py
```

#### macOS 系统
```bash
# 使用 Homebrew 安装
brew install libimobiledevice libplist libusbmuxd pkg-config

# 使用项目提供的安装脚本
./build.sh install-deps
```

#### Linux 系统
```bash
# 使用 apt 包管理器
sudo apt-get install libimobiledevice-dev libplist-dev libusbmuxd-dev pkg-config build-essential

# 使用项目提供的安装脚本
./build.sh install-deps
```

## 构建项目

### Windows 系统
```bash
# 使用项目提供的构建脚本
./build.bat

# 或使用 CMake 手动构建
mkdir build
cd build
cmake .. -G "Visual Studio 16 2019" -A x64
cmake --build . --config Release
```

### macOS/Linux 系统
```bash
# 使用项目提供的构建脚本
./build.sh

# 或使用 CMake 手动构建
mkdir build
cd build
cmake ..
make -j$(nproc)
```

## 基本使用

### 1. 连接设备
1. 使用 USB 数据线连接 iOS 设备到电脑
2. 在 iOS 设备上点击"信任此电脑"
3. 等待设备驱动程序安装完成

### 2. 应用程序使用
运行构建生成的可执行文件：
- Windows: `build/Release/phone-linkc.exe`
- macOS/Linux: `build/phone-linkc`

### 3. 基本功能
- 查看连接的设备信息
- 安装/卸载应用
- 管理文件和媒体
- 备份和恢复数据

## 常见问题

### 1. 设备未识别
- 确认 iOS 设备已解锁并信任此电脑
- 检查 USB 数据线是否正常工作
- 确认已安装正确的驱动程序

### 2. 编译错误
- 确认所有依赖已正确安装
- 检查 CMake 配置是否正确
- 确认编译器版本符合要求

### 3. 运行时错误
- 检查设备连接状态
- 查看日志文件获取详细错误信息
- 尝试重新连接设备

## 高级用法

### 1. 命令行工具
项目提供了一些命令行工具，可以通过它们直接与设备交互：
```bash
# 列出连接的设备
idevice_id -l

# 获取设备信息
ideviceinfo

# 安装应用
ideviceinstaller -i app.ipa
```

### 2. 开发指南
如果您想为项目贡献代码或进行二次开发，请参考：
- [API-REFERENCE.md](API-REFERENCE.md)：详细的 API 接口文档
- [FUNCTION-GUIDE.md](FUNCTION-GUIDE.md)：功能使用指南
- 项目源码中的注释和文档

## libimobiledevice 工具使用指南

本项目依赖 libimobiledevice 提供的命令行工具，以下工具可在 `phone-linkc/thirdparty/libimobiledevice` 目录中找到：

### 基本工具

#### idevice_id.exe - 设备ID查询工具
用于列出或查询连接的 iOS 设备。

```bash
# 列出所有连接的设备
idevice_id.exe -l

# 获取特定设备的UDID
idevice_id.exe [设备编号]
```

#### ideviceinfo.exe - 设备信息查询工具
获取 iOS 设备的详细系统信息。

```bash
# 获取所有设备信息
ideviceinfo.exe

# 获取特定域的信息
ideviceinfo.exe -u [设备UDID] -q [查询域]

# 示例：获取设备基本信息
ideviceinfo.exe -q "DeviceClass"
ideviceinfo.exe -q "ProductType"
ideviceinfo.exe -q "ProductVersion"
```

#### idevicescreenshot.exe - 屏幕截图工具
捕获 iOS 设备的屏幕截图。

```bash
# 保存截图到文件
idevicescreenshot.exe [文件名.png]

# 不指定文件名，自动生成带时间戳的文件名
idevicescreenshot.exe
```

### 应用管理工具

#### ideviceinstaller.exe - 应用安装工具
管理 iOS 设备上的应用程序。

```bash
# 列出已安装的应用
ideviceinstaller.exe -l

# 列出系统应用
ideviceinstaller.exe -l -o list_system

# 列出用户应用
ideviceinstaller.exe -l -o list_user

# 安装应用
ideviceinstaller.exe -i [应用文件.ipa]

# 卸载应用
ideviceinstaller.exe -U [应用BundleID]

# 获取应用信息
ideviceinstaller.exe -I [应用BundleID]

# 归档应用
ideviceinstaller.exe -a [应用BundleID] [归档文件.ipa]
```

### 系统工具

#### idevicesyslog.exe - 系统日志工具
实时查看 iOS 设备的系统日志。

```bash
# 实时显示设备日志
idevicesyslog.exe

# 显示特定进程的日志
ideviceinfo.exe -u [设备UDID] | idevicesyslog.exe

# 将日志保存到文件
idevicesyslog.exe > log.txt
```

#### usbmuxd.exe - USB复用守护进程
管理与 iOS 设备的 USB 连接。

```bash
# 启动守护进程
usbmuxd.exe -f -v

# 以调试模式运行
usbmuxd.exe -f -vvvv
```

### 使用示例

#### 完整的工作流程示例
```bash
# 1. 检查连接的设备
idevice_id.exe -l

# 2. 获取设备信息
ideviceinfo.exe -u [设备UDID] -q "DeviceName"

# 3. 捕获屏幕截图
idevicescreenshot.exe my_screenshot.png

# 4. 安装应用
ideviceinstaller.exe -u [设备UDID] -i my_app.ipa

# 5. 查看设备日志
idevicesyslog.exe -u [设备UDID]
```

### 注意事项

1. 所有工具都需要设备已连接并信任此电脑
2. 某些操作可能需要设备已解锁
3. 使用 `-u [设备UDID]` 参数可以指定特定设备（多设备连接时）
4. 工具路径需添加到系统环境变量或使用完整路径调用

## 许可证

本项目采用 MIT 许可证，详见 [LICENSE](../../LICENSE) 文件。